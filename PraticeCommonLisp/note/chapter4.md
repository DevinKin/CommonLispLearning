- [语法和语义](#sec-1)
  - [S表达式](#sec-1-1)
  - [作为Lisp形式的S-表达式](#sec-1-2)
  - [函数调用](#sec-1-3)
  - [特殊操作符](#sec-1-4)
  - [宏](#sec-1-5)
  - [真、假和等价](#sec-1-6)

# 语法和语义<a id="sec-1"></a>

S-表达式可以用来表达任意树形表达式。

## S表达式<a id="sec-1-1"></a>

S-表达式的基本元素是列表（list）和原子（atom）。

列表有括号所包围，并可包含任何数量的由空格所分隔的元素。

原子是所有其他内容。

下面的表达式包含了两个符号、空列表以及另一个列表，其本身又含有两个符号和一个字符串。

```common-lisp
(defun hello-world ()
  (format t "hello, world"))
```

## 作为Lisp形式的S-表达式<a id="sec-1-2"></a>

原子可以被分为两个类别

-   符号
-   其他内容

符号在作为Lisp形式被求值时会被视为一个变量名，并且会被求值为该变量的当前值。

另一类自求值的符号是关键字符号，以名字冒号开始的符号。当读取器保留这样一个名字时，它会自动定义一个以此命名的常值变量并以该符号作为其值。

所有的合法列表形式均以一个符号开始，但是有三种类型的列表形式，他们会以三种相当不同的方式进行求值。

-   函数调用形式
-   宏形式
-   特殊形式

## 函数调用<a id="sec-1-3"></a>

对以Lisp形式存在的列表其余元素进行求值并将结果传递到命名函数中。除了第一个以外，所有的列表元素他们自身必须是一个形态良好的Lisp形式。

函数调用形式的基本语法如下

```common-lisp
(funtion-name argument*)
```

## 特殊操作符<a id="sec-1-4"></a>

Common Lisp特殊操作符有25个。

`QUOTE` 操作符 `'` 使用比较频繁，它接受一个单一表达式作为其“参数”并简单地返回它，不经求值。

## 宏<a id="sec-1-5"></a>

宏是一个以S-表达式作为其参数的函数，并返回一个Lisp形式，然后对其求值并用该值取代宏形式。

宏形式的求值过程包括两个阶段

-   宏形式的元素不经求值即被传递到宏函数里面
-   宏函数所返回的形式(展开式)，按照正常的求值规则进行求值

由于求值器在将宏形式传递给宏函数之前并不对它们求值，因此它们不需要是格式良好的Lisp形式。

每个宏都为其红星是中的符号表达式指定了一种含义，用以制定宏将如何使用它们生成的展开式。

## 真、假和等价<a id="sec-1-6"></a>

符号 `NIL` 是唯一的假值，其他所有的都是真值。

符号 `T` 是标准的真值。

`()` 可以表示空列表和 `NIL` 。

四个通用的谓词：

-   `EQ` ：用来测试“对象标识”，只有两个对象相同才返回真。
-   `EQL` ：相同类型的两个对象表示相同的数值或字符时，才返回真。
-   `EQUAL` ：允许认为不同的对象是等价的，值相等即可。
-   `EQUALP` ：字符串忽略了大小写，比 `EQUAL` 更宽松。
